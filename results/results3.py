# file = "TFIDF.txt"
filename = "miniLMBalance.txt"
file_path = f"./results/{filename}"  # Replace "your_file_path_here.txt" with the actual file path
with open(file_path, "r") as file:
    text_data = file.read()





import pandas as pd
import re

# Define a function to extract data from the text using regular expressions
def extract_data(text):
    pattern = r"classifier: (\w+): ([\d.]+)\nprecision macro: ([\d.]+)\nprecision weighted: ([\d.]+)\nrecall macro: ([\d.]+)\nrecall weighted: ([\d.]+)\nf1 macro: ([\d.]+)\nf1 weighted: ([\d.]+)\nauc: ([\d.]+)"
    matches = re.findall(pattern, text)
    data = {
        'Classifier': [],
        'Accuracy': [],
        'Precision Macro': [],
        'Precision Weighted': [],
        'Recall Macro': [],
        'Recall Weighted': [],
        'F1 Macro': [],
        'F1 Weighted': [],
        'AUC': []
    }
    for classifier, accuracy, precision_macro, precision_weighted, recall_macro, recall_weighted, f1_macro, f1_weighted, auc in matches:
        data['Classifier'].append(classifier)
        data['Accuracy'].append(float(accuracy))
        data['Precision Macro'].append(float(precision_macro))
        data['Precision Weighted'].append(float(precision_weighted))
        data['Recall Macro'].append(float(recall_macro))
        data['Recall Weighted'].append(float(recall_weighted))
        data['F1 Macro'].append(float(f1_macro))
        data['F1 Weighted'].append(float(f1_weighted))
        data['AUC'].append(float(auc))
    return data


# Parse the text data and extract the relevant information
extracted_data = extract_data(text_data)

# Create a DataFrame from the extracted data
df = pd.DataFrame(extracted_data)

# Write the data to an Excel file
excel_file_path = f"./results/final/results{filename}.xlsx"  # File path for the Excel file
df.to_excel(excel_file_path, index=False)

print("Data for all classifiers has been written to:", excel_file_path)
